<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to automate your system installs and keep your application configuration in dotfiles | xrazis · Haris Razis</title>
<meta name=keywords content="Linux"><meta name=description content="Introduction
Dotfiles are user-specific application configuration files that your filesystem does not display by default, and they
start with a dot (ie ~/.gitconfig). It is common to host them in a git repository in order to keep a consistent
environment across machines. We are going to automate some of our application installs and symlink our system dotfiles
to a git repository.
Repository structure and Dotfiles
Firstly initialize a git repository, ie my GitHub repo has the following structure."><meta name=author content><link rel=canonical href=https://haris.razis.com/posts/dotfiles/><link crossorigin=anonymous href=/assets/css/stylesheet.7ada26225601177355d925d8020cc425b32600338001f38a6a764b249f875c98.css integrity="sha256-etomIlYBF3NV2SXYAgzEJbMmADOAAfOKanZLJJ+HXJg=" rel="preload stylesheet" as=style><link rel=icon href=https://haris.razis.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://haris.razis.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://haris.razis.com/favicon.png><link rel=apple-touch-icon href=https://haris.razis.com/apple-touch-icon.png><link rel=mask-icon href=https://haris.razis.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://haris.razis.com/posts/dotfiles/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="How to automate your system installs and keep your application configuration in dotfiles"><meta property="og:description" content="Introduction
Dotfiles are user-specific application configuration files that your filesystem does not display by default, and they
start with a dot (ie ~/.gitconfig). It is common to host them in a git repository in order to keep a consistent
environment across machines. We are going to automate some of our application installs and symlink our system dotfiles
to a git repository.
Repository structure and Dotfiles
Firstly initialize a git repository, ie my GitHub repo has the following structure."><meta property="og:type" content="article"><meta property="og:url" content="https://haris.razis.com/posts/dotfiles/"><meta property="og:image" content="https://haris.razis.com/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-02T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-02T00:00:00+00:00"><meta property="og:site_name" content="xrazis"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://haris.razis.com/"><meta name=twitter:title content="How to automate your system installs and keep your application configuration in dotfiles"><meta name=twitter:description content="Introduction
Dotfiles are user-specific application configuration files that your filesystem does not display by default, and they
start with a dot (ie ~/.gitconfig). It is common to host them in a git repository in order to keep a consistent
environment across machines. We are going to automate some of our application installs and symlink our system dotfiles
to a git repository.
Repository structure and Dotfiles
Firstly initialize a git repository, ie my GitHub repo has the following structure."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://haris.razis.com/posts/"},{"@type":"ListItem","position":2,"name":"How to automate your system installs and keep your application configuration in dotfiles","item":"https://haris.razis.com/posts/dotfiles/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to automate your system installs and keep your application configuration in dotfiles","name":"How to automate your system installs and keep your application configuration in dotfiles","description":"Introduction Dotfiles are user-specific application configuration files that your filesystem does not display by default, and they start with a dot (ie ~/.gitconfig). It is common to host them in a git repository in order to keep a consistent environment across machines. We are going to automate some of our application installs and symlink our system dotfiles to a git repository.\nRepository structure and Dotfiles Firstly initialize a git repository, ie my GitHub repo has the following structure.\n","keywords":["Linux"],"articleBody":"Introduction Dotfiles are user-specific application configuration files that your filesystem does not display by default, and they start with a dot (ie ~/.gitconfig). It is common to host them in a git repository in order to keep a consistent environment across machines. We are going to automate some of our application installs and symlink our system dotfiles to a git repository.\nRepository structure and Dotfiles Firstly initialize a git repository, ie my GitHub repo has the following structure.\nA handy linux package is tree, a recursive directory listing program that lists contents in a tree-like format. I’ve used it with the option -a which prints all files including dotfiles, and -I which ignores the given directories. The command used for the tree generated bellow is tree -a -I .git.\n. ├── git │ └── .gitconfig ├── .idea │ ├── dotfiles.iml │ ├── .gitignore │ ├── modules.xml │ ├── vcs.xml │ └── workspace.xml ├── install.sh ├── LICENSE ├── logiops │ └── logid.cfg ├── pop │ └── .config │ └── pop-shell │ └── config.json ├── scripts │ ├── apts.sh │ ├── directs.sh │ ├── flatpaks.sh │ └── snaps.sh └── zsh └── .zshrc At the top level we have the install.sh file which is the entry point of our script, and a directory for each of the configuration files. Let’s have a deeper look at install.sh.\n#!/bin/bash if [ ! -f /usr/bin/stow ] then sudo apt-get install stow fi if [ \"$1\" == \"apps\" ] then source ./scripts/apts.sh source ./scripts/directs.sh source ./scripts/snaps.sh source ./scripts/flatpaks.sh fi rm ../.zshrc \\ ../.config/pop-shell/config.json \\ ../.gitconfig \\ /etc/logid.cfg stow zsh \\ pop \\ git stow -t /etc logiops echo \"Done!\" The first line of the script is a shebang - it tells our system what interpreter to use. Afterward we are going to check if stow is installed. Stow is a symlink farm manager that was originally used to manage software packages. Despite that not being the case today - as there are more sophisticated package managers available - it is still being used to manage configuration files in a controlled and organized way, exactly what we need!\nUsing stow is quite simple, just append the configuration file you want to symlink after the command and voilà! If the directory you want to symlink from is not the working dir you can change that with the - t option. The way stow symlinks is quite interesting, be sure to read the man page.\nThe dotfiles are application specific. Copy the respective file and customize it to your needs.\nInstallation automation Installing apps in a fresh system can get tedious, shouldn’t we automate much of that with a simple script?\n#!/bin/bash echo \"Installing snapd...\" apt install -y snapd echo \"Installing speedtest...\" apt install -y speedtest-cli echo \"Installing restic...\" apt install -y restic echo \"Installing curl...\" apt install -y curl echo \"Installing httpie\" apt install -y httpie echo \"Installing termius...\" curl -OL https://www.termius.com/download/linux/Termius.deb dpkg -i Termius.deb # ... The applications will be installed serially, just like they would when installing them standalone in the terminal. Make sure to provide any input that an app might need (ie - y for apt packages). You can also test them in a Multipass virtual machine.\nRepository https://github.com/xrazis/dotfiles/ ","wordCount":"534","inLanguage":"en","image":"https://haris.razis.com/","datePublished":"2023-10-02T00:00:00Z","dateModified":"2023-10-02T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://haris.razis.com/posts/dotfiles/"},"publisher":{"@type":"Organization","name":"xrazis · Haris Razis","logo":{"@type":"ImageObject","url":"https://haris.razis.com/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://haris.razis.com/ accesskey=h title="Haris Razis (Alt + H)">Haris Razis</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://haris.razis.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://haris.razis.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">How to automate your system installs and keep your application configuration in dotfiles</h1><div class=post-meta><span title='2023-10-02 00:00:00 +0000 UTC'>2 October, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;534 words</div></header><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>Dotfiles are user-specific application configuration files that your filesystem does not display by default, and they
start with a dot (ie <code>~/.gitconfig</code>). It is common to host them in a git repository in order to keep a consistent
environment across machines. We are going to automate some of our application installs and symlink our system dotfiles
to a git repository.</p><h1 id=repository-structure-and-dotfiles>Repository structure and Dotfiles<a hidden class=anchor aria-hidden=true href=#repository-structure-and-dotfiles>#</a></h1><p>Firstly initialize a git repository, ie my GitHub repo has the following structure.</p><blockquote><p>A handy linux package is <code>tree</code>, a recursive directory listing program that lists contents in a tree-like format. I&rsquo;ve
used it with the option <code>-a</code> which prints all files including dotfiles, and <code>-I</code> which ignores the given
directories. The command used for the tree generated bellow is <code>tree -a -I .git</code>.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── git
</span></span><span style=display:flex><span>│ └── .gitconfig
</span></span><span style=display:flex><span>├── .idea
</span></span><span style=display:flex><span>│ ├── dotfiles.iml
</span></span><span style=display:flex><span>│ ├── .gitignore
</span></span><span style=display:flex><span>│ ├── modules.xml
</span></span><span style=display:flex><span>│ ├── vcs.xml
</span></span><span style=display:flex><span>│ └── workspace.xml
</span></span><span style=display:flex><span>├── install.sh
</span></span><span style=display:flex><span>├── LICENSE
</span></span><span style=display:flex><span>├── logiops
</span></span><span style=display:flex><span>│ └── logid.cfg
</span></span><span style=display:flex><span>├── pop
</span></span><span style=display:flex><span>│ └── .config
</span></span><span style=display:flex><span>│ └── pop-shell
</span></span><span style=display:flex><span>│ └── config.json
</span></span><span style=display:flex><span>├── scripts
</span></span><span style=display:flex><span>│ ├── apts.sh
</span></span><span style=display:flex><span>│ ├── directs.sh
</span></span><span style=display:flex><span>│ ├── flatpaks.sh
</span></span><span style=display:flex><span>│ └── snaps.sh
</span></span><span style=display:flex><span>└── zsh
</span></span><span style=display:flex><span>└── .zshrc
</span></span></code></pre></div><p>At the top level we have the <code>install.sh</code> file which is the entry point of our script, and a directory for each of the
configuration files. Let&rsquo;s have a deeper look at <code>install.sh</code>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#0f0;font-weight:700>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#0f0;font-weight:700></span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>if</span> [ ! -f /usr/bin/stow ]
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>then</span>
</span></span><span style=display:flex><span>	sudo apt-get install stow
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>if</span> [ <span style=color:#0ff;font-weight:700>&#34;</span>$1<span style=color:#0ff;font-weight:700>&#34;</span> == <span style=color:#0ff;font-weight:700>&#34;apps&#34;</span> ]
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>then</span>
</span></span><span style=display:flex><span>	<span style=color:#fff;font-weight:700>source</span> ./scripts/apts.sh
</span></span><span style=display:flex><span>	<span style=color:#fff;font-weight:700>source</span> ./scripts/directs.sh
</span></span><span style=display:flex><span>	<span style=color:#fff;font-weight:700>source</span> ./scripts/snaps.sh
</span></span><span style=display:flex><span>	<span style=color:#fff;font-weight:700>source</span> ./scripts/flatpaks.sh
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rm ../.zshrc <span style=color:#0ff;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700></span>	../.config/pop-shell/config.json <span style=color:#0ff;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700></span>	../.gitconfig <span style=color:#0ff;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700></span>	/etc/logid.cfg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stow zsh <span style=color:#0ff;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700></span>	pop <span style=color:#0ff;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700></span>	git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stow -t /etc logiops
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>echo</span> <span style=color:#0ff;font-weight:700>&#34;Done!&#34;</span>
</span></span></code></pre></div><p>The first line of the script is a shebang - it tells our system what interpreter to use. Afterward we are
going to check if stow is installed. Stow is a symlink farm manager that was originally used to manage software
packages. Despite that not being the case today - as there are more sophisticated package managers available - it is
still being used to manage configuration files in a controlled and organized way, exactly what we need!</p><p>Using stow is quite simple, just append the configuration file you want to symlink after the command and voilà! If the
directory you want to symlink from is not the working dir you can change that with the <code>- t</code> option. The way stow
symlinks is quite interesting, be sure to read the <a href=https://linux.die.net/man/8/stow>man page</a>.</p><p>The dotfiles are application specific. Copy the respective file and customize it to your needs.</p><h1 id=installation-automation>Installation automation<a hidden class=anchor aria-hidden=true href=#installation-automation>#</a></h1><p>Installing apps in a fresh system can get tedious, shouldn&rsquo;t we automate much of that with a simple script?</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#0f0;font-weight:700>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#0f0;font-weight:700></span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>echo</span> <span style=color:#0ff;font-weight:700>&#34;Installing snapd...&#34;</span>
</span></span><span style=display:flex><span>apt install -y snapd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>echo</span> <span style=color:#0ff;font-weight:700>&#34;Installing speedtest...&#34;</span>
</span></span><span style=display:flex><span>apt install -y speedtest-cli
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>echo</span> <span style=color:#0ff;font-weight:700>&#34;Installing restic...&#34;</span>
</span></span><span style=display:flex><span>apt install -y restic
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>echo</span> <span style=color:#0ff;font-weight:700>&#34;Installing curl...&#34;</span>
</span></span><span style=display:flex><span>apt install -y curl
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>echo</span> <span style=color:#0ff;font-weight:700>&#34;Installing httpie&#34;</span>
</span></span><span style=display:flex><span>apt install -y httpie
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>echo</span> <span style=color:#0ff;font-weight:700>&#34;Installing termius...&#34;</span>
</span></span><span style=display:flex><span>curl -OL https://www.termius.com/download/linux/Termius.deb
</span></span><span style=display:flex><span>dpkg -i Termius.deb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f># ...</span>
</span></span></code></pre></div><p>The applications will be installed serially, just like they would when installing them standalone in the terminal. Make
sure to provide any input that an app might need (ie <code>- y</code> for apt packages). You can also test them
in a <a href=https://multipass.run/>Multipass</a> virtual machine.</p><h1 id=repository>Repository<a hidden class=anchor aria-hidden=true href=#repository>#</a></h1><ul><li><a href=https://github.com/xrazis/dotfiles/>https://github.com/xrazis/dotfiles/</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://haris.razis.com/tags/linux/>Linux</a></li></ul></footer></article></main><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>